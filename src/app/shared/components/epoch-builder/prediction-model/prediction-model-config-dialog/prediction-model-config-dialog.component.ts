import { Component, OnInit, Inject } from '@angular/core';
import {MatDialogRef, MAT_DIALOG_DATA} from "@angular/material/dialog";
import { IPredictionModelConfig } from '../../../../../core';
import { NavService, AppService } from '../../../../../services';
import { IPredictionModelConfigDialogComponent } from './interfaces';

@Component({
  selector: 'app-prediction-model-config-dialog',
  templateUrl: './prediction-model-config-dialog.component.html',
  styleUrls: ['./prediction-model-config-dialog.component.scss']
})
export class PredictionModelConfigDialogComponent implements OnInit, IPredictionModelConfigDialogComponent {
	// Model Data
	public model: IPredictionModelConfig;

	// Tabs
	public activeIndex: number = 0;

	constructor(
		public dialogRef: MatDialogRef<PredictionModelConfigDialogComponent>,
		@Inject(MAT_DIALOG_DATA) private data: IPredictionModelConfig,
		public _nav: NavService,
		public _app: AppService,
	) { 
		this.model = this.data;
	}

	ngOnInit(): void {

	}



    // Tooltip
    public displayTooltip(): void {
        this._nav.displayTooltip("Prediction Model", [
            `The prediction model is an ensemble of regressions trained to predict Bitcoin's near-future trend. 
			Since the market is always changing, a complete recalibration is performed every few months.`,
            `The model predicts every ~10 seconds. Each prediction is broadcast, stored and used to create the 
            15-minute-interval candlesticks that are then used to calculate the trend state. The key pieces of 
            information derived from the model are:`,
            `1) Trend Sum: the sum of all the predictions generated by the regressions. This value can range from 0.000001 to 8 if the 
			model is predicting the trend will increase. It can also range from -0.000001 to -8 if the model is predicting the trend will 
			decrease.`,
            `2) Min Increase Sum: the trend sum at which the up-trend is considered to be very strong.`,
            `3) Min Decrease Sum: the trend sum at which the down-trend is considered to be very strong.`,
            `4) Trend State: the trend state makes use of a 32 hours window comprised by 15-minute-interval candlesticks in order to determine 
			if the trend is increasing or decreasing. This piece of data is useful to determine if a trend is getting stronger or weaker.`,
        ]);
    }


	// Close Dialog
	public close(): void { this.dialogRef.close() }
}
