<mat-toolbar mat-dialog-title color="primary" fxLayout="row" fxLayoutAlign="start center">
    <div fxLayout="row" fxLayoutAlign="center center">
        <button mat-icon-button class="show-on-mobile" (click)="close()"><mat-icon>arrow_back</mat-icon></button>
        <span class="truncate">Technicals {{intervalID}}</span>
        <span fxFlex></span>
        <button mat-icon-button (click)="displayTooltip()" matTooltip="More information"><mat-icon>question_mark</mat-icon></button>
        <button mat-icon-button class="show-on-desktop" (click)="close()"><mat-icon>close</mat-icon></button>
    </div>
</mat-toolbar>
<div mat-dialog-content>
    <!-- Loader -->
    <div *ngIf="!loaded">
        <div class="loader show-on-desktop"><div fxLayout="row" fxLayoutAlign="center center"><mat-spinner diameter="50"></mat-spinner></div></div>
        <div class="section-loader show-on-mobile"><div fxLayout="row" fxLayoutAlign="center center"><mat-spinner diameter="50"></mat-spinner></div></div>
    </div>
    <div *ngIf="loaded && intervalState">
        <!-- Tabs Navigation-->
        <mat-tab-group [selectedIndex]="activeIndex" (selectedIndexChange)="activeIndex = $event" 
            mat-align-tabs="center" 
            mat-stretch-tabs  
            backgroundColor="primary">
            <mat-tab label="RESULT"></mat-tab>
            <mat-tab label="OSC"></mat-tab>
            <mat-tab label="MA"></mat-tab>
        </mat-tab-group>

        <!-- Result -->
        <div *ngIf="activeIndex == 0" class="padding">
            <!-- Summary -->
            <div>
                <div fxLayout="row" fxLayoutAlign="start center">
                    <h5>Summary</h5>
                    <span fxFlex></span>
                    <div [ngClass]="{
                            'square-badge-success': intervalState.s.a > 0,
                            'square-badge-error': intervalState.s.a < 0,
                            'square-badge-neutral': intervalState.s.a == 0,
                            'state': intervalState.s.a != -2 && intervalState.s.a != 2
                        }">
                        {{_ms.taStates[intervalState.s.a]}}
                    </div>
                </div>
                <div fxLayout="row">
                    <div class="sell-action-container" 
                        matTooltip="Sell: {{summary.s}}%" 
                        matTooltipPosition="above" 
                        *ngIf="summary.s > 0" 
                        [fxFlex]="summary.s"><p>{{intervalState.s.s}}</p></div>
                    <div class="neutral-action-container" 
                        matTooltip="Neutral: {{summary.n}}%" 
                        matTooltipPosition="above" 
                        *ngIf="summary.n > 0" 
                        [fxFlex]="summary.n"><p>{{intervalState.s.n}}</p></div>
                    <div class="buy-action-container" 
                        matTooltip="Buy: {{summary.b}}%" 
                        matTooltipPosition="above" 
                        *ngIf="summary.b > 0" 
                        [fxFlex]="summary.b"><p>{{intervalState.s.b}}</p></div>
                </div>
            </div>

            <div class="divider"></div>

            <!-- Oscillators -->
            <div>
                <div fxLayout="row" fxLayoutAlign="start center">
                    <h5>Oscillators</h5>
                    <span fxFlex></span>
                    <div [ngClass]="{
                            'square-badge-success': intervalState.o.a > 0,
                            'square-badge-error': intervalState.o.a < 0,
                            'square-badge-neutral': intervalState.o.a == 0,
                            'state': intervalState.o.a != -2 && intervalState.o.a != 2
                        }">
                        {{_ms.taStates[intervalState.o.a]}}
                    </div>
                </div>
                <div fxLayout="row">
                    <div class="sell-action-container" 
                        matTooltip="Sell: {{oscillators.s}}%" 
                        matTooltipPosition="above" 
                        [fxFlex]="oscillators.s"><p>{{intervalState.o.s}}</p></div>
                    <div class="neutral-action-container" 
                        matTooltip="Neutral: {{oscillators.n}}%" 
                        matTooltipPosition="above" 
                        [fxFlex]="oscillators.n"><p>{{intervalState.o.n}}</p></div>
                    <div class="buy-action-container" 
                        matTooltip="Buy: {{oscillators.b}}%" 
                        matTooltipPosition="above" 
                        [fxFlex]="oscillators.b"><p>{{intervalState.o.b}}</p></div>
                </div>
            </div>

            <div class="divider"></div>

            <!-- Moving Averages -->
            <div>
                <div fxLayout="row" fxLayoutAlign="start center">
                    <h5 class="truncate">Moving Averages</h5>
                    <span fxFlex></span>
                    <div [ngClass]="{
                            'square-badge-success': intervalState.m.a > 0,
                            'square-badge-error': intervalState.m.a < 0,
                            'square-badge-neutral': intervalState.m.a == 0,
                            'state': intervalState.m.a != -2 && intervalState.m.a != 2
                        }">
                        {{_ms.taStates[intervalState.m.a]}}
                    </div>
                </div>
                <div fxLayout="row">
                    <div class="sell-action-container" 
                        matTooltip="Sell: {{movingAverages.s}}%" 
                        matTooltipPosition="above" 
                        *ngIf="movingAverages.s > 0" 
                        [fxFlex]="movingAverages.s"><p>{{intervalState.m.s}}</p></div>
                    <div class="neutral-action-container" 
                        matTooltip="Neutral: {{movingAverages.n}}%" 
                        matTooltipPosition="above" 
                        *ngIf="movingAverages.n > 0" 
                        [fxFlex]="movingAverages.n"><p>{{intervalState.m.n}}</p></div>
                    <div class="buy-action-container" 
                        matTooltip="Buy: {{movingAverages.b}}%" 
                        matTooltipPosition="above" 
                        *ngIf="movingAverages.b > 0" 
                        [fxFlex]="movingAverages.b"><p>{{intervalState.m.b}}</p></div>
                </div>
            </div>
        </div>

        <!-- Oscillators -->
        <div *ngIf="activeIndex == 1">
            <table class="bordered highlight">
                <tbody>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Relative Strength Index (14)': 'RSI (14)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.rsi_14.a == 'BUY',
                                'error-color': intervalState.p.rsi_14.a == 'SELL',
                                'light-text': intervalState.p.rsi_14.a == 'NEUTRAL',
                                'strong-action': intervalState.p.rsi_14.a != 'NEUTRAL'
                            }">
                            {{intervalState.p.rsi_14.v[0] | number: '1.2-2'}}
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Commodity Channel Index (20)': 'CCI (20)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.cci_20.a == 'BUY',
                                'error-color': intervalState.p.cci_20.a == 'SELL',
                                'light-text': intervalState.p.cci_20.a == 'NEUTRAL',
                                'strong-action': intervalState.p.cci_20.a != 'NEUTRAL'
                            }">
                            {{intervalState.p.cci_20.v[0] | number: '1.2-2'}}
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Average Directional Movement Index (14)': 'ADX (14)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.adx_14.a == 'BUY',
                                'error-color': intervalState.p.adx_14.a == 'SELL',
                                'light-text': intervalState.p.adx_14.a == 'NEUTRAL',
                                'strong-action': intervalState.p.adx_14.a != 'NEUTRAL'
                            }">
                            {{intervalState.p.adx_14.v[0] | number: '1.2-2'}}
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Awesome Oscillator': 'AO'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.ao.a == 'BUY',
                                'error-color': intervalState.p.ao.a == 'SELL',
                                'light-text': intervalState.p.ao.a == 'NEUTRAL',
                                'strong-action': intervalState.p.ao.a != 'NEUTRAL'
                            }">
                            {{intervalState.p.ao.v[0] | number: '1.2-2'}}
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Momentum (10)': 'MOM (10)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.mom_10.a == 'BUY',
                                'error-color': intervalState.p.mom_10.a == 'SELL',
                                'light-text': intervalState.p.mom_10.a == 'NEUTRAL',
                                'strong-action': intervalState.p.mom_10.a != 'NEUTRAL'
                            }">
                            {{intervalState.p.mom_10.v[0] | number: '1.2-2'}}
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'MACD Level (12, 26, 9)': 'MACD (12, 26, 9)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.macd_12_26_9.a == 'BUY',
                                'error-color': intervalState.p.macd_12_26_9.a == 'SELL',
                                'light-text': intervalState.p.macd_12_26_9.a == 'NEUTRAL',
                                'strong-action': intervalState.p.macd_12_26_9.a != 'NEUTRAL'
                            }">
                            {{intervalState.p.macd_12_26_9.v[0] | number: '1.2-2'}}
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Stoch (14, 1, 3)': 'STOCH (14, 1, 3)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.stoch_14_1_3.a == 'BUY',
                                'error-color': intervalState.p.stoch_14_1_3.a == 'SELL',
                                'light-text': intervalState.p.stoch_14_1_3.a == 'NEUTRAL',
                                'strong-action': intervalState.p.stoch_14_1_3.a != 'NEUTRAL'
                            }">
                            {{intervalState.p.stoch_14_1_3.v[0] | number: '1.2-2'}}
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Stochastic RSI (14)': 'STOCHRSI (14)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.stochrsi_14.a == 'BUY',
                                'error-color': intervalState.p.stochrsi_14.a == 'SELL',
                                'light-text': intervalState.p.stochrsi_14.a == 'NEUTRAL',
                                'strong-action': intervalState.p.stochrsi_14.a != 'NEUTRAL'
                            }">
                            {{intervalState.p.stochrsi_14.v[0] | number: '1.2-2'}}
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Williams Percent Range (14)': 'WILLR (14)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.willr_14.a == 'BUY',
                                'error-color': intervalState.p.willr_14.a == 'SELL',
                                'light-text': intervalState.p.willr_14.a == 'NEUTRAL',
                                'strong-action': intervalState.p.willr_14.a != 'NEUTRAL'
                            }">
                            {{intervalState.p.willr_14.v[0] | number: '1.2-2'}}
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Ultimate Oscillator (7, 14, 28)': 'ULTOSC (7, 14, 28)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.ultosc_7_14_28.a == 'BUY',
                                'error-color': intervalState.p.ultosc_7_14_28.a == 'SELL',
                                'light-text': intervalState.p.ultosc_7_14_28.a == 'NEUTRAL',
                                'strong-action': intervalState.p.ultosc_7_14_28.a != 'NEUTRAL'
                            }">
                            {{intervalState.p.ultosc_7_14_28.v[0] | number: '1.2-2'}}
                            </p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Moving Averages -->
        <div *ngIf="activeIndex == 2">
            <table class="bordered highlight">
                <tbody>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Exponential Moving Average (10)': 'EMA (10)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.ema_10.a == 'BUY',
                                'error-color': intervalState.p.ema_10.a == 'SELL',
                                'light-text': intervalState.p.ema_10.a == 'NEUTRAL'
                            }">
                                <strong>{{intervalState.p.ema_10.v[0] | number: '1.2-2'}}</strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Simple Moving Average (10)': 'SMA (10)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.sma_10.a == 'BUY',
                                'error-color': intervalState.p.sma_10.a == 'SELL',
                                'light-text': intervalState.p.sma_10.a == 'NEUTRAL'
                            }">
                                <strong>{{intervalState.p.sma_10.v[0] | number: '1.2-2'}}</strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Exponential Moving Average (20)': 'EMA (20)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.ema_20.a == 'BUY',
                                'error-color': intervalState.p.ema_20.a == 'SELL',
                                'light-text': intervalState.p.ema_20.a == 'NEUTRAL'
                            }">
                                <strong>{{intervalState.p.ema_20.v[0] | number: '1.2-2'}}</strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Simple Moving Average (20)': 'SMA (20)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.sma_20.a == 'BUY',
                                'error-color': intervalState.p.sma_20.a == 'SELL',
                                'light-text': intervalState.p.sma_20.a == 'NEUTRAL'
                            }">
                                <strong>{{intervalState.p.sma_20.v[0] | number: '1.2-2'}}</strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Exponential Moving Average (30)': 'EMA (30)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.ema_30.a == 'BUY',
                                'error-color': intervalState.p.ema_30.a == 'SELL',
                                'light-text': intervalState.p.ema_30.a == 'NEUTRAL'
                            }">
                                <strong>{{intervalState.p.ema_30.v[0] | number: '1.2-2'}}</strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Simple Moving Average (30)': 'SMA (30)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.sma_30.a == 'BUY',
                                'error-color': intervalState.p.sma_30.a == 'SELL',
                                'light-text': intervalState.p.sma_30.a == 'NEUTRAL'
                            }">
                                <strong>{{intervalState.p.sma_30.v[0] | number: '1.2-2'}}</strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Exponential Moving Average (50)': 'EMA (50)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.ema_50.a == 'BUY',
                                'error-color': intervalState.p.ema_50.a == 'SELL',
                                'light-text': intervalState.p.ema_50.a == 'NEUTRAL'
                            }">
                                <strong>{{intervalState.p.ema_50.v[0] | number: '1.2-2'}}</strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Simple Moving Average (50)': 'SMA (50)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.sma_50.a == 'BUY',
                                'error-color': intervalState.p.sma_50.a == 'SELL',
                                'light-text': intervalState.p.sma_50.a == 'NEUTRAL'
                            }">
                                <strong>{{intervalState.p.sma_50.v[0] | number: '1.2-2'}}</strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Exponential Moving Average (100)': 'EMA (100)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.ema_100.a == 'BUY',
                                'error-color': intervalState.p.ema_100.a == 'SELL',
                                'light-text': intervalState.p.ema_100.a == 'NEUTRAL'
                            }">
                                <strong>{{intervalState.p.ema_100.v[0] | number: '1.2-2'}}</strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Simple Moving Average (100)': 'SMA (100)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.sma_100.a == 'BUY',
                                'error-color': intervalState.p.sma_100.a == 'SELL',
                                'light-text': intervalState.p.sma_100.a == 'NEUTRAL'
                            }">
                                <strong>{{intervalState.p.sma_100.v[0] | number: '1.2-2'}}</strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Exponential Moving Average (200)': 'EMA (200)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.ema_200.a == 'BUY',
                                'error-color': intervalState.p.ema_200.a == 'SELL',
                                'light-text': intervalState.p.ema_200.a == 'NEUTRAL'
                            }">
                                <strong>{{intervalState.p.ema_200.v[0] | number: '1.2-2'}}</strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Simple Moving Average (200)': 'SMA (200)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.sma_200.a == 'BUY',
                                'error-color': intervalState.p.sma_200.a == 'SELL',
                                'light-text': intervalState.p.sma_200.a == 'NEUTRAL'
                            }">
                                <strong>{{intervalState.p.sma_200.v[0] | number: '1.2-2'}}</strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td><p>{{layout == 'desktop' ? 'Hull Moving Average (9)': 'HMA (9)'}}</p></td>
                        <td class="align-right">
                            <p [ngClass]="{
                                'success-color': intervalState.p.hma_9.a == 'BUY',
                                'error-color': intervalState.p.hma_9.a == 'SELL',
                                'light-text': intervalState.p.hma_9.a == 'NEUTRAL'
                            }">
                                <strong>{{intervalState.p.hma_9.v[0] | number: '1.2-2'}}</strong>
                            </p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
