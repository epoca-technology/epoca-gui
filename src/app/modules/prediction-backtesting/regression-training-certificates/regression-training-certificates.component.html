<!-- Section Container -->
<mat-drawer-container class="section-container component-container">

    <!-- Main Sidenav -->
    <mat-drawer #regTrainingCertificatesSidenav [(opened)]="regTrainingCertificatesSidenavOpened" *ngIf="initialized"
                class="sidenav" position="start" mode="over" autoFocus="false">
        <!-- Menu Heading Toolbar -->
        <mat-toolbar color="primary">
            <div fxLayout="row" fxLayoutAlign="start center">
                <button mat-icon-button (click)="regTrainingCertificatesSidenav?.toggle()"><mat-icon>arrow_back</mat-icon></button>
                <span class="truncate">Regr. Training Certificates</span>
                <span fxFlex></span>
            </div>
        </mat-toolbar>

        <!-- Menu Content -->
        <mat-list>
            <div mat-subheader>General</div>
            <mat-list-item *ngFor="let sect of generalSections">
                <button mat-button class="left-icon-button" [disabled]="section.id == sect.id" (click)="navigate(sect.id)">
                    <mat-icon>{{sect.icon}}</mat-icon> {{sect.name}}
                </button>
            </mat-list-item>
            <div mat-subheader>
                Certificates&nbsp;
                <mat-icon *ngIf="order == 'general_points'" class="order-icon" matTooltip="Ordered by General Points">query_stats</mat-icon>
                <mat-icon *ngIf="order == 'reg_eval_acc'" class="order-icon" matTooltip="Ordered by Regression Evaluation Accuracy">rule</mat-icon>
                <mat-icon *ngIf="order == 'reg_eval_points'" class="order-icon" matTooltip="Ordered by Regression Evaluation Points">attach_money</mat-icon>
            </div>
            <mat-list-item *ngFor="let certificate of _training.certificates; index as certIndex">
                <button mat-button class="left-icon-button truncate" 
                        [disabled]="section.id == 'certificate' && cert && certificate.id == cert.id" 
                        (click)="navigate('certificate', certIndex)">
                        <div fxLayout="row" fxLayoutAlign="start center">
                            <span class="truncate" style="max-width: 70%;">{{certificate.id}}</span>
                            <span fxFlex></span>
                            <div *ngIf="order == 'general_points'" 
                                [ngClass]="certificate.general.state_class" 
                                class="square-badge"><span>{{certificate.general.points | number: '1.2-2'}}</span></div>
                            <div *ngIf="order == 'reg_eval_acc'" class="square-badge"><span>{{certificate.regression_evaluation.acc | number: '1.2-2'}}%</span></div>
                            <div *ngIf="order == 'reg_eval_points'"
                                [ngClass]="{
                                    'square-badge': certificate.regression_evaluation.points_median == 0,
                                    'square-badge-success': certificate.regression_evaluation.points_median > 0,
                                    'square-badge-error': certificate.regression_evaluation.points_median < 0
                                }">
                                <span>
                                    {{certificate.regression_evaluation.points_median | number: '1.2-2'}}
                                </span>
                            </div>
                        </div>
                </button>
            </mat-list-item>
        </mat-list>
    </mat-drawer>


    <!-- Section Content -->
    <mat-drawer-content id="content-header">
        <!-- Content Header -->
        <mat-toolbar class="secondary-header">
            <div fxLayout="row" fxLayoutAlign="center center">
                <button mat-icon-button (click)="_nav.dashboard()" class="show-on-mobile" *ngIf="!initialized"><mat-icon>arrow_back</mat-icon></button>
                <button mat-icon-button (click)="reset()" class="show-on-mobile" *ngIf="initialized && _training.certificates && _training.certificates.length >= 1"><mat-icon>arrow_back</mat-icon></button>
                <button mat-icon-button (click)="regTrainingCertificatesSidenav?.toggle()" *ngIf="initialized" class="show-on-mobile"><mat-icon>menu</mat-icon></button>
                <span class="truncate show-on-mobile" *ngIf="!initialized">Regr. Training Certificates</span>
                <span class="truncate show-on-mobile" *ngIf="initialized">{{section.id == 'certificate' ? cert!.id: section.name}}</span>
                <span class="truncate show-on-desktop">Regression Training Certificates</span>
                <span fxFlex></span>
                <button mat-icon-button 
                        matTooltip="Clear Training Certificates"
                        (click)="reset()"
                        class="show-on-desktop"
                        *ngIf="initialized"><mat-icon>close</mat-icon></button>
            </div>
        </mat-toolbar>



        <!-- Uninitialized Content -->
        <div *ngIf="!initialized" class="fadeIn">
            <div fxLayout="row" fxLayoutAlign="center center" class="file-init-container">
                <!-- Button -->
                <label for="certificatesFile" class="file-label" role="button" matRipple *ngIf="!initializing">
                    <div fxLayout="row" fxLayoutAlign="start center" matRipple role="button" tabindex="0">
                        <mat-icon svgIcon="file_signature"></mat-icon>&nbsp;
                        <p>Select Certificates</p>
                    </div>
                </label>

                <!-- Input -->
                <form [formGroup]="fileInputForm">
                    <input id="certificatesFile" type="file" accept="application/json" 
                            formControlName="fileInput" (change)="fileChanged($event)" multiple/>
                </form>

                <!-- Initializing Loader-->
                <h3 *ngIf="initializing" class="fadeIn">Initializing...</h3>
            </div>
        </div>



        <!-- Initialized Content -->
        <div *ngIf="initialized" class="fadeIn">
            <!-- Sections -->
            <div fxLayout="row">
                <div *ngIf="layout == 'desktop'" class="desktop-sidenav">
                    <mat-list>
                        <div mat-subheader>General</div>
                        <mat-list-item *ngFor="let sect of generalSections">
                            <button mat-button class="left-icon-button" [disabled]="section.id == sect.id" (click)="navigate(sect.id)">
                                <mat-icon>{{sect.icon}}</mat-icon> {{sect.name}}
                            </button>
                        </mat-list-item>
                        <div mat-subheader>
                            Certificates&nbsp;
                            <mat-icon *ngIf="order == 'general_points'" class="order-icon" matTooltip="Ordered by General Points">query_stats</mat-icon>
                            <mat-icon *ngIf="order == 'reg_eval_acc'" class="order-icon" matTooltip="Ordered by Regression Evaluation Accuracy">rule</mat-icon>
                            <mat-icon *ngIf="order == 'reg_eval_points'" class="order-icon" matTooltip="Ordered by Regression Evaluation Points">attach_money</mat-icon>
                        </div>
                        <mat-list-item *ngFor="let certificate of _training.certificates; index as certIndex">
                            <button mat-button class="left-icon-button truncate" 
                                    [disabled]="section.id == 'certificate' && cert && certificate.id == cert.id" 
                                    (click)="navigate('certificate', certIndex)">
                                    <div fxLayout="row" fxLayoutAlign="start center">
                                        <span class="truncate" style="max-width: 70%;">{{certificate.id}}</span>
                                        <span fxFlex></span>
                                        <div *ngIf="order == 'general_points'" 
                                        [ngClass]="certificate.general.state_class" 
                                        class="square-badge"><span>{{certificate.general.points | number: '1.2-2'}}</span></div>
                                        <div *ngIf="order == 'reg_eval_acc'" class="square-badge"><span>{{certificate.regression_evaluation.acc | number: '1.2-2'}}%</span></div>
                                        <div *ngIf="order == 'reg_eval_points'"
                                            [ngClass]="{
                                                'square-badge': certificate.regression_evaluation.points_median == 0,
                                                'square-badge-success': certificate.regression_evaluation.points_median > 0,
                                                'square-badge-error': certificate.regression_evaluation.points_median < 0
                                            }">
                                            <span>
                                                {{certificate.regression_evaluation.points_median | number: '1.2-2'}}
                                            </span>
                                        </div>
                                    </div>
                            </button>
                        </mat-list-item>
                    </mat-list>
                </div>
                <div fxFlex>
                    <!-- Loader -->
                    <div *ngIf="!loaded" class="loader">
                        <div fxLayout="row" fxLayoutAlign="center center"><mat-spinner diameter="50"></mat-spinner></div>
                    </div>

                    <!-- Sections -->
                    <div *ngIf="loaded" class="fadeIn">
                        <!-- General Sections -->
                        <div class="general-sections" 
                            *ngIf="section.id != 'certificate' && points && regAccuracies && regGeneralPoints && regPredictions  && epochs">


                            <!-- General Evaluation-->
                            <div *ngIf="section.id == 'general_evaluations'" class="epochs">
                                <div fxLayout="row" fxLayoutAlign="center center">
                                    <div fxFlex="60" fxFlex.xs="100" fxFlex.sm="100">
                                        <div class="desktop-card">
                                            <div fxLayout="row" fxLayoutAlign="center center" class="badged-header">
                                                <h3 class="show-on-desktop">General Evaluations</h3>
                                                <span class="show-on-desktop" fxFlex></span>
                                                <div class="square-badge clickable" role="button"
                                                    (click)="navigate('certificate', _training.pointsMetadata.highest.index)"
                                                    matTooltip="Highest # of Points: {{_training.pointsMetadata.highest.id}}">
                                                    Best: {{_training.pointsMetadata.highest.value | number: '1.0-2'}}
                                                </div>
                                                <div class="square-badge clickable lowest" role="button"
                                                    (click)="navigate('certificate', _training.pointsMetadata.lowest.index)"
                                                    matTooltip="Lowest # of Points: {{_training.pointsMetadata.lowest.id}}">
                                                    Worst: {{_training.pointsMetadata.lowest.value | number: '1.0-2'}}
                                                </div>
                                            </div>
                                            <apx-chart
                                                [series]="points.series"
                                                [chart]="points.chart"
                                                [plotOptions]="points.plotOptions"
                                                [xaxis]="points.xaxis"
                                                [yaxis]="points.yaxis"
                                                [dataLabels]="points.dataLabels"
                                                [colors]="points.colors"
                                                [grid]="points.grid"
                                            ></apx-chart>
                                        </div>
                                    </div>
                                </div>
                            </div>




                            <!-- Regression Evaluation -->
                            <div *ngIf="section.id == 'reg_evaluations'" class="reg_evaluations">
                                <!-- Tabs Navigation-->
                                <mat-tab-group *ngIf="layout == 'mobile'" 
                                            [selectedIndex]="activeRegTabIndex" (selectedIndexChange)="activeRegTabIndex = $event"
                                            class="mat-elevation-z3" backgroundColor="primary">
                                    <mat-tab><ng-template mat-tab-label><mat-icon>ads_click</mat-icon></ng-template></mat-tab>
                                    <mat-tab><ng-template mat-tab-label><mat-icon>attach_money</mat-icon></ng-template></mat-tab>
                                    <mat-tab><ng-template mat-tab-label><mat-icon svgIcon="wand_magic_sparkles" class="wand-icon"></mat-icon></ng-template></mat-tab>
                                </mat-tab-group>
                                <mat-tab-group *ngIf="layout == 'desktop'"  
                                                [selectedIndex]="activeRegTabIndex" (selectedIndexChange)="activeRegTabIndex = $event" 
                                                mat-align-tabs="center">
                                    <mat-tab><ng-template mat-tab-label><mat-icon>ads_click</mat-icon>&nbsp;Accuracies</ng-template></mat-tab>            
                                    <mat-tab><ng-template mat-tab-label><mat-icon>attach_money</mat-icon>&nbsp;Points</ng-template></mat-tab>               
                                    <mat-tab><ng-template mat-tab-label><mat-icon svgIcon="wand_magic_sparkles" class="wand-icon"></mat-icon>&nbsp;Predictions</ng-template></mat-tab>      
                                </mat-tab-group>

                                <!-- General Regression Content-->
                                <div class="padding">

                                    <!-- Accuracies-->
                                    <div *ngIf="activeRegTabIndex == 0">
                                        <div fxLayout="row" fxLayoutAlign="center center">
                                            <div fxFlex="60" fxFlex.xs="100" fxFlex.sm="100">
                                                <div class="desktop-card">
                                                    <div fxLayout="row" fxLayoutAlign="center center" class="badged-header">
                                                        <h3 class="show-on-desktop">Accuracies</h3>
                                                        <span class="show-on-desktop" fxFlex></span>
                                                        <div class="square-badge clickable" role="button"
                                                            (click)="navigate('certificate', _training.accuraciesMetadata.highest.index)"
                                                            matTooltip="Best Accuracy: {{_training.accuraciesMetadata.highest.id}}">
                                                            Best: {{_training.accuraciesMetadata.highest.value | number: '1.2-3'}}%
                                                        </div>
                                                        <div class="square-badge clickable lowest" role="button"
                                                            (click)="navigate('certificate', _training.accuraciesMetadata.lowest.index)"
                                                            matTooltip="Worst Accuracy: {{_training.accuraciesMetadata.lowest.id}}">
                                                            Worst: {{_training.accuraciesMetadata.lowest.value | number: '1.2-3'}}%
                                                        </div>
                                                    </div>
                                                    <div class="margin-top">
                                                        <apx-chart
                                                            [series]="regAccuracies.series"
                                                            [chart]="regAccuracies.chart"
                                                            [plotOptions]="regAccuracies.plotOptions"
                                                            [xaxis]="regAccuracies.xaxis"
                                                            [yaxis]="regAccuracies.yaxis"
                                                            [dataLabels]="regAccuracies.dataLabels"
                                                            [colors]="regAccuracies.colors"
                                                            [grid]="regAccuracies.grid"
                                                            [legend]="{position: 'top'}"
                                                        ></apx-chart>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                    <!-- Points-->
                                    <div *ngIf="activeRegTabIndex == 1">
                                        <div fxLayout="row" fxLayoutAlign="center center">
                                            <div fxFlex="60" fxFlex.xs="100" fxFlex.sm="100">
                                                <div class="desktop-card">
                                                    <div fxLayout="row" fxLayoutAlign="center center" class="badged-header">
                                                        <h3 class="show-on-desktop">Points</h3>
                                                        <span class="show-on-desktop" fxFlex></span>
                                                        <div class="square-badge clickable" role="button"
                                                            (click)="navigate('certificate', _training.regPointsMetadata.highest.index)"
                                                            matTooltip="Best Points: {{_training.regPointsMetadata.highest.id}}">
                                                            Best: {{_training.regPointsMetadata.highest.value | number: '1.2-3'}}
                                                        </div>
                                                        <div class="square-badge clickable lowest" role="button"
                                                            (click)="navigate('certificate', _training.regPointsMetadata.lowest.index)"
                                                            matTooltip="Worst Points: {{_training.regPointsMetadata.lowest.id}}">
                                                            Worst: {{_training.regPointsMetadata.lowest.value | number: '1.0-2'}}
                                                        </div>
                                                    </div>
                                                    <div class="margin-top">
                                                        <apx-chart
                                                            [series]="regGeneralPoints.series"
                                                            [chart]="regGeneralPoints.chart"
                                                            [plotOptions]="regGeneralPoints.plotOptions"
                                                            [xaxis]="regGeneralPoints.xaxis"
                                                            [yaxis]="regGeneralPoints.yaxis"
                                                            [dataLabels]="regGeneralPoints.dataLabels"
                                                            [colors]="regGeneralPoints.colors"
                                                            [grid]="regGeneralPoints.grid"
                                                        ></apx-chart>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                    <!-- Predictions -->
                                    <div *ngIf="activeRegTabIndex == 2">
                                        <div fxLayout="row" fxLayoutAlign="center center">
                                            <div fxFlex="60" fxFlex.xs="100" fxFlex.sm="100">
                                                <div class="desktop-card">
                                                    <div fxLayout="row" fxLayoutAlign="center center" class="badged-header">
                                                        <h3 class="show-on-desktop">Predictions</h3>
                                                        <span class="show-on-desktop" fxFlex></span>
                                                        <div class="square-badge clickable" role="button"
                                                            (click)="navigate('certificate', _training.predictionsMetadata.highest.index)"
                                                            matTooltip="Highest # of Predictions: {{_training.predictionsMetadata.highest.id}}">
                                                            Highest: {{_training.predictionsMetadata.highest.value | number}}
                                                        </div>
                                                        <div class="square-badge clickable lowest" role="button"
                                                            (click)="navigate('certificate', _training.predictionsMetadata.lowest.index)"
                                                            matTooltip="Lowest # of Predictions: {{_training.predictionsMetadata.lowest.id}}">
                                                            Lowest: {{_training.predictionsMetadata.lowest.value | number}}
                                                        </div>
                                                    </div>
                                                    <div class="margin-top">
                                                        <apx-chart
                                                            [series]="regPredictions.series"
                                                            [chart]="regPredictions.chart"
                                                            [plotOptions]="regPredictions.plotOptions"
                                                            [xaxis]="regPredictions.xaxis"
                                                            [yaxis]="regPredictions.yaxis"
                                                            [dataLabels]="regPredictions.dataLabels"
                                                            [colors]="regPredictions.colors"
                                                            [grid]="regPredictions.grid"
                                                            [legend]="{position: 'top'}"
                                                        ></apx-chart>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>


    
                            <!-- Epochs-->
                            <div *ngIf="section.id == 'epochs'" class="epochs">
                                <div fxLayout="row" fxLayoutAlign="center center">
                                    <div fxFlex="60" fxFlex.xs="100" fxFlex.sm="100">
                                        <div class="desktop-card">
                                            <div fxLayout="row" fxLayoutAlign="center center" class="badged-header">
                                                <h3 class="show-on-desktop">Epochs</h3>
                                                <span class="show-on-desktop" fxFlex></span>
                                                <div class="square-badge clickable" role="button"
                                                    (click)="navigate('certificate', _training.epochsMetadata.highest.index)"
                                                    matTooltip="Highest # of Epochs: {{_training.epochsMetadata.highest.id}}">
                                                    Highest: {{_training.epochsMetadata.highest.value | number}}
                                                </div>
                                                <div class="square-badge clickable lowest" role="button"
                                                    (click)="navigate('certificate', _training.epochsMetadata.lowest.index)"
                                                    matTooltip="Lowest # of Epochs: {{_training.epochsMetadata.lowest.id}}">
                                                    Lowest: {{_training.epochsMetadata.lowest.value | number}}
                                                </div>
                                            </div>
                                            <apx-chart
                                                [series]="epochs.series"
                                                [chart]="epochs.chart"
                                                [plotOptions]="epochs.plotOptions"
                                                [xaxis]="epochs.xaxis"
                                                [yaxis]="epochs.yaxis"
                                                [dataLabels]="epochs.dataLabels"
                                                [colors]="epochs.colors"
                                                [grid]="epochs.grid"
                                            ></apx-chart>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
    
    
    
                        <!-- Certificate Section -->
                        <div class="certificate-section" 
                            *ngIf="section.id == 'certificate' && cert && trainLoss && 
                                regAccuracy && regPoints && regPrediction && regOutcome">
                            <!-- Tabs Navigation-->
                            <mat-tab-group *ngIf="layout == 'mobile'" 
                                        [selectedIndex]="activeTabIndex" (selectedIndexChange)="activeTabIndex = $event"
                                        mat-stretch-tabs class="mat-elevation-z3" backgroundColor="primary">
                                <mat-tab><ng-template mat-tab-label><mat-icon>feed</mat-icon></ng-template></mat-tab>
                                <mat-tab><ng-template mat-tab-label><mat-icon>cast_for_education</mat-icon></ng-template></mat-tab>
                                <mat-tab><ng-template mat-tab-label><mat-icon>rule</mat-icon></ng-template></mat-tab>
                                <mat-tab><ng-template mat-tab-label><mat-icon svgIcon="wand_magic_sparkles" class="wand-icon"></mat-icon></ng-template></mat-tab>
                                <mat-tab><ng-template mat-tab-label><mat-icon>format_list_numbered</mat-icon></ng-template></mat-tab>
                            </mat-tab-group>
                            <mat-tab-group *ngIf="layout == 'desktop'"  
                                            [selectedIndex]="activeTabIndex" (selectedIndexChange)="activeTabIndex = $event" 
                                            mat-align-tabs="center">
                                <mat-tab><ng-template mat-tab-label><mat-icon>feed</mat-icon>&nbsp;Summary</ng-template></mat-tab>
                                <mat-tab><ng-template mat-tab-label><mat-icon>cast_for_education</mat-icon>&nbsp;Training</ng-template></mat-tab>
                                <mat-tab><ng-template mat-tab-label><mat-icon>rule</mat-icon>&nbsp;Evaluation</ng-template></mat-tab>
                                <mat-tab><ng-template mat-tab-label><mat-icon svgIcon="wand_magic_sparkles" class="wand-icon"></mat-icon>&nbsp;Positions</ng-template></mat-tab>
                                <mat-tab><ng-template mat-tab-label><mat-icon>format_list_numbered</mat-icon>&nbsp;Epochs</ng-template></mat-tab>
                            </mat-tab-group>
    
                            <!-- Summary -->
                            <div *ngIf="activeTabIndex == 0" class="summary-content fadeIn">
                                <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column">
                                    <!-- Informational Cards-->
                                    <div fxFlex="44" fxFlex.xs="100" fxFlex.sm="100" class="full-width">
                                        <!-- Training Certificate -->
                                        <div class="desktop-card">
                                            <div class="certificate-header badged-header" fxLayout="row" fxLayoutAlign="start center">
                                                <h3 class="truncate">{{layout == 'desktop' ? "Certificate": "Cert."}}</h3>
                                                <span fxFlex></span>
                                                <div class="square-badge clickable" role="button" 
                                                    matTooltip="Regression Evaluation Accuracy" 
                                                    (click)="activeTabIndex=2">
                                                    {{cert.regression_evaluation.acc | number: '1.2-2'}}%
                                                </div>
                                                <div class="square-badge clickable" role="button" 
                                                    matTooltip="Regression Evaluation Points Median" 
                                                    (click)="activeTabIndex=2">
                                                    {{cert.regression_evaluation.points_median | number: '1.2-2'}}
                                                </div>
                                            </div>

                                            <p class="ts-m margin-top">{{cert.description}}</p>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text">Regr.</p>
                                                <span fxFlex></span>
                                                <app-regression-element [config]="cert.regression_config"></app-regression-element>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text truncate">Keras Model</p>
                                                <span fxFlex></span>
                                                <p class="clickable" role="button" 
                                                    matTooltip="Configuration used to build the Keras Regression Model"
                                                    (click)="_nav.displayDataDialog('KerasModelConfiguration', cert.keras_model_config)">
                                                    {{cert.keras_model_config.name}}
                                                </p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text truncate">Optimizer</p>
                                                <span fxFlex></span>
                                                <p>{{cert.optimizer}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text">Loss</p>
                                                <span fxFlex></span>
                                                <p>{{cert.loss}}</p>
                                            </div>
                                        </div>

                                        <div class="divider show-on-mobile"></div>

                                        <!-- Training Data -->
                                        <div class="desktop-card">
                                            <h3>Training Data</h3>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text truncate">T. Data Start</p>
                                                <span fxFlex></span>
                                                <p matTooltip="The initial candlestick's open time in the train dataset.">{{cert.training_data_start | date:'medium'}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text truncate">T. Data End</p>
                                                <span fxFlex></span>
                                                <p matTooltip="The last candlestick's close time in the train dataset.">{{cert.training_data_end | date:'medium'}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text">Train Size</p>
                                                <span fxFlex></span>
                                                <p>{{cert.train_size | number}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text">Test Size</p>
                                                <span fxFlex></span>
                                                <p>{{cert.test_size | number}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text">Dataset Size</p>
                                                <span fxFlex></span>
                                                <p>{{cert.training_data_summary.count | number}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text">Mean</p>
                                                <span fxFlex></span>
                                                <p>{{cert.training_data_summary.mean}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text">STD</p>
                                                <span fxFlex></span>
                                                <p>{{cert.training_data_summary.std}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text">Min</p>
                                                <span fxFlex></span>
                                                <p>{{cert.training_data_summary.min}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text">25%</p>
                                                <span fxFlex></span>
                                                <p>{{cert.training_data_summary["25%"]}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text">50%</p>
                                                <span fxFlex></span>
                                                <p>{{cert.training_data_summary["50%"]}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text">75%</p>
                                                <span fxFlex></span>
                                                <p>{{cert.training_data_summary["75%"]}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text">Max</p>
                                                <span fxFlex></span>
                                                <p>{{cert.training_data_summary.max}}</p>
                                            </div>
                                        </div>
                                    </div>

                                    <span fxFlex></span>
                                    <div class="divider show-on-mobile"></div>

                                    <!-- General Evaluation -->
                                    <div fxFlex="54" fxFlex.xs="100" fxFlex.sm="100" class="full-width general-evaluation">
                                        <div class="desktop-card">
                                            <!-- Header -->
                                            <div class="badged-header general-header" fxLayout="row" fxLayoutAlign="start center">
                                                <h3 class="truncate">General Evaluation</h3>
                                                <span fxFlex></span>
                                                <div class="square-badge"
                                                    [ngClass]="cert.general.state_class"
                                                    matTooltip="Total points collected during the general evaluation.">
                                                    {{cert.general.points | number: '1.0-2'}} / {{cert.general.max_points | number: '1.0-2'}}
                                                </div>
                                            </div>

                                            <!-- Items -->
                                            <div class="fadeIn">
                                                <div *ngFor="let item of cert.general.items; last as lastItem" 
                                                    class="item clickable" role="button" 
                                                    (click)="_nav.displayTooltip(item.name, item.description)">
                                                    <div fxLayout="row" fxLayoutAlign="start start">
                                                        <div fxFlex="80" fxFlex.xs="70" fxFlex.sm="70">
                                                            <p class="truncate light-text"><strong>{{item.name}}</strong></p>
                                                            <p class="light-text ts-m">{{item.state}}</p>
                                                        </div>
                                                        <span fxFlex></span>
                                                        <div [ngClass]="item.state_class" class="square-badge">
                                                            {{item.points | number: '1.0-2'}} / {{item.max_points | number: '1.0-2'}}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <!-- Training -->
                            <div *ngIf="activeTabIndex == 1" class="reg-evals-content">
                                <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column">
                                    <!-- Informational Cards-->
                                    <div fxFlex="40" fxFlex.xs="100" fxFlex.sm="100" class="full-width">
                                        <!-- Training Certificate -->
                                        <div class="desktop-card">
                                            <div class="certificate-header" fxLayout="row" fxLayoutAlign="start center">
                                                <h3 class="truncate">Training</h3>
                                                <span fxFlex></span>
                                                <div class="square-badge clickable" role="button" 
                                                matTooltip="The number of epochs the training process went through before being stopped by the EarlyStopping Callback."
                                                    (click)="activeTabIndex=4">
                                                    Epochs: {{cert.training_history.loss.length}}
                                                </div>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text">Regr.</p>
                                                <span fxFlex></span>
                                                <app-regression-element [config]="cert.regression_config"></app-regression-element>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text truncate">Keras Model</p>
                                                <span fxFlex></span>
                                                <p class="clickable" role="button" 
                                                    matTooltip="Configuration used to build the Keras Regression Model"
                                                    (click)="_nav.displayDataDialog('KerasModelConfiguration', cert.keras_model_config)">
                                                    {{cert.keras_model_config.name}}
                                                </p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text truncate">Optimizer</p>
                                                <span fxFlex></span>
                                                <p>{{cert.optimizer}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text">Loss</p>
                                                <span fxFlex></span>
                                                <p>{{cert.loss}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text">Train Size</p>
                                                <span fxFlex></span>
                                                <p>{{cert.train_size | number}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text">Test Size</p>
                                                <span fxFlex></span>
                                                <p>{{cert.test_size | number}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text truncate">Train Start</p>
                                                <span fxFlex></span>
                                                <p matTooltip="The time when the model started training.">{{cert.training_start | date:'medium'}}</p>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="margin-top">
                                                <p class="light-text truncate">Train End</p>
                                                <span fxFlex></span>
                                                <p matTooltip="The time when the model finished training.">{{cert.training_end | date:'medium'}}</p>
                                            </div>
                                        </div>
                                    </div>

                                    <span fxFlex></span>
                                    <div class="divider show-on-mobile"></div>

                                    <!-- Training Charts -->
                                    <div fxFlex="58" fxFlex.xs="100" fxFlex.sm="100" class="full-width">
                                        <!-- Loss -->
                                        <div class="desktop-card">
                                            <div class="loss-header badged-header" fxLayout="row" fxLayoutAlign="start center">
                                                <h3 class="truncate">{{layout == 'desktop' ? 'Training & Validation Loss': 'Loss'}}</h3>
                                                <span fxFlex></span>
                                                <div class="square-badge loss" matTooltip="Final Train Loss">
                                                    {{cert.training_history.loss[cert.training_history.loss.length - 1] | number: '1.2-6'}}
                                                </div>
                                                <div class="square-badge val-loss" matTooltip="Final Validation Loss">
                                                    {{cert.training_history.val_loss[cert.training_history.val_loss.length - 1] | number: '1.2-6'}}
                                                </div>
                                            </div>
                                            <apx-chart
                                                [series]="trainLoss.series"
                                                [chart]="trainLoss.chart"
                                                [xaxis]="trainLoss.xaxis"
                                                [dataLabels]="trainLoss.dataLabels"
                                                [grid]="trainLoss.grid"
                                                [stroke]="trainLoss.stroke"
                                                [yaxis]="trainLoss.yaxis"
                                            ></apx-chart>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <!-- Regression Evaluation -->
                            <div *ngIf="activeTabIndex == 2" class="reg-evals-content">
                                <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxLayoutalign="center start">
                                    <!-- Regr. Accuracy -->
                                    <div fxFlex="40" fxFlex.xs="100" fxFlex.sm="100" class="full-width">
                                        <div class="desktop-card">
                                            <div class="badged-header" fxLayout="row" fxLayoutAlign="start center">
                                                <h3 class="truncate">{{layout == 'desktop' ? 'Accuracy': 'Acc.'}}</h3>
                                                <span fxFlex></span>
                                                <div class="square-badge-success" matTooltip="Regression Evaluation Increase Accuracy">
                                                    {{cert.regression_evaluation.increase_acc | number: '1.2-2'}}%
                                                </div>
                                                <div class="square-badge-error" matTooltip="Regression Evaluation Decrease Accuracy">
                                                    {{cert.regression_evaluation.decrease_acc | number: '1.2-2'}}%
                                                </div>
                                                <div class="square-badge" matTooltip="Regression Evaluation General Accuracy">
                                                    {{cert.regression_evaluation.acc | number: '1.2-2'}}%
                                                </div>
                                            </div>
                                            <div>
                                                <apx-chart
                                                    [series]="regAccuracy.series"
                                                    [chart]="regAccuracy.chart"
                                                    [plotOptions]="regAccuracy.plotOptions"
                                                    [xaxis]="regAccuracy.xaxis"
                                                    [yaxis]="regAccuracy.yaxis"
                                                    [dataLabels]="regAccuracy.dataLabels"
                                                    [colors]="regAccuracy.colors"
                                                    [grid]="regAccuracy.grid"
                                                ></apx-chart>
                                            </div>
                                        </div>

                                        <div class="divider show-on-mobile"></div>

                                        <div class="desktop-card predicted-trends-container">
                                            <h3>Predicted Trends</h3>
                                            <table class="bordered highlight">
                                                <thead>
                                                    <tr>
                                                        <th></th>
                                                        <th>Min</th>
                                                        <th>Mean</th>
                                                        <th>Max</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td><strong>Increase</strong></td>
                                                        <td class="success-color">{{cert.regression_evaluation.increase_min | number}}%</td>
                                                        <td class="success-color">{{cert.regression_evaluation.increase_mean | number}}%</td>
                                                        <td class="success-color">{{cert.regression_evaluation.increase_max | number}}%</td>
                                                    </tr>
                                                    <tr>
                                                        <td><strong>Incr. Succ.</strong></td>
                                                        <td class="success-color"><strong>{{cert.regression_evaluation.increase_successful_min | number}}%</strong></td>
                                                        <td class="success-color"><strong>{{cert.regression_evaluation.increase_successful_mean | number}}%</strong></td>
                                                        <td class="success-color"><strong>{{cert.regression_evaluation.increase_successful_max | number}}%</strong></td>
                                                    </tr>
                                                    <tr>
                                                        <td><strong>Decrease</strong></td>
                                                        <td class="error-color">{{cert.regression_evaluation.decrease_min | number}}%</td>
                                                        <td class="error-color">{{cert.regression_evaluation.decrease_mean | number}}%</td>
                                                        <td class="error-color">{{cert.regression_evaluation.decrease_max | number}}%</td>
                                                    </tr>
                                                    <tr>
                                                        <td><strong>Decr. Succ.</strong></td>
                                                        <td class="error-color"><strong>{{cert.regression_evaluation.decrease_successful_min | number}}%</strong></td>
                                                        <td class="error-color"><strong>{{cert.regression_evaluation.decrease_successful_mean | number}}%</strong></td>
                                                        <td class="error-color"><strong>{{cert.regression_evaluation.decrease_successful_max | number}}%</strong></td>
                                                    </tr>
                                                </tbody>
                                            </table>

                                        </div>
                                    </div>

                                    <span fxFlex></span>

                                    <div class="divider show-on-mobile"></div>

                                    
                                    <div fxFlex="58" fxFlex.xs="100" fxFlex.sm="100" class="full-width">
                                        
                                        
                                        <!-- Positions Chart -->
                                        <div class="desktop-card">
                                            <div class="badged-header" fxLayout="row" fxLayoutAlign="start center">
                                                <h3 class="truncate">{{layout == "desktop" ? "Positions History": "Pos. Hist."}}</h3>
                                                <span fxFlex></span>
                                                <div class="square-badge" 
                                                    matTooltip="Median of the points collected during the Regression Evaluation">
                                                    Median: {{cert.regression_evaluation.points_median | number}}
                                                </div>
                                                <div class="square-badge" 
                                                    matTooltip="Final points collected during the Regression Evaluation">
                                                    Final: {{cert.regression_evaluation.positions[cert.regression_evaluation.positions.length-1].pts | number}}
                                                </div>
                                            </div>

                                            <div>
                                                <apx-chart
                                                    [series]="regPoints.series"
                                                    [chart]="regPoints.chart"
                                                    [plotOptions]="regPoints.plotOptions"
                                                    [xaxis]="regPoints.xaxis"
                                                    [dataLabels]="regPoints.dataLabels"
                                                    [colors]="regPoints.colors"
                                                    [grid]="regPoints.grid"
                                                    [legend]="{show: false}"
                                                    [yaxis]="regPoints.yaxis"
                                                ></apx-chart>
                                            </div>
                                        </div>

                                        <div class="divider show-on-mobile"></div>

                                        <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" class="full-width">
                                            <!-- Predictions -->
                                            <div fxFlex="49">
                                                <div class="desktop-card">
                                                    <div class="badged-header" fxLayout="row" fxLayoutAlign="start center">
                                                        <h3 class="truncate">{{layout == 'desktop' ? 'Predictions': 'Preds.'}}</h3>
                                                        <span fxFlex></span>
                                                        <div class="square-badge-success" 
                                                            matTooltip="The number of increase predictions generated by the Regression.">
                                                            {{cert.regression_evaluation.increase_num | number}}
                                                        </div>
                                                        <div class="square-badge-error" 
                                                            matTooltip="The number of decrease predictions generated by the Regression.">
                                                            {{cert.regression_evaluation.decrease_num | number}}
                                                        </div>
                                                        <div class="square-badge" 
                                                            matTooltip="The number of non-neutral predictions generated by the Regression.
                                                            A total of {{cert.regression_evaluation.neutral_predictions}} neutral predictions
                                                            were generated.">
                                                            {{cert.regression_evaluation.positions.length | number}}
                                                        </div>
                                                    </div>
    
                                                    <div>
                                                        <apx-chart
                                                            [series]="regPrediction.series"
                                                            [chart]="regPrediction.chart"
                                                            [labels]="regPrediction.labels"
                                                            [colors]="regPrediction.colors"
                                                            [legend]="regPrediction.legend"
                                                            [responsive]="regPrediction.responsive"
                                                        ></apx-chart>
                                                    </div>
                                                </div>
                                            </div>

                                            <span fxFlex></span>
                                            <div class="divider show-on-mobile"></div>

                                            <!-- Outcomes -->
                                            <div fxFlex="49">
                                                <div class="desktop-card">
                                                    <div class="badged-header" fxLayout="row" fxLayoutAlign="start center">
                                                        <h3 class="truncate">{{layout == 'desktop' ? 'Outcomes': 'Outs.'}}</h3>
                                                        <span fxFlex></span>
                                                        <div class="square-badge-success" 
                                                            matTooltip="The number of increase outcomes during the evaluation.">
                                                            {{cert.regression_evaluation.increase_outcomes | number}}
                                                        </div>
                                                        <div class="square-badge-error" 
                                                            matTooltip="The number of decrease outcomes during the evaluation.">
                                                            {{cert.regression_evaluation.decrease_outcomes | number}}
                                                        </div>
                                                        <div class="square-badge" 
                                                            matTooltip="The total number outcomes during the evaluation.">
                                                            {{cert.regression_evaluation.increase_outcomes + 
                                                                cert.regression_evaluation.decrease_outcomes | number}}
                                                        </div>
                                                    </div>

                                                    <div>
                                                        <apx-chart
                                                            [series]="regOutcome.series"
                                                            [chart]="regOutcome.chart"
                                                            [labels]="regOutcome.labels"
                                                            [colors]="regOutcome.colors"
                                                            [legend]="regOutcome.legend"
                                                            [responsive]="regOutcome.responsive"
                                                        ></apx-chart>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>



                            <!-- Positions -->
                            <div *ngIf="activeTabIndex == 3" class="positions-content fadeIn">
                                <div fxLayout="row" fxLayoutAlign="center center">
                                    <div fxFlex="60" fxFlex.xs="100" fxFlex.sm="100">
                                        <!-- Positions Table -->
                                        <div class="desktop-card">
                                            <table class="bordered highlight">
                                                <thead>
                                                    <tr>
                                                        <th>#</th>
                                                        <th>Open</th>
                                                        <th *ngIf="layout == 'desktop'">Close</th>
                                                        <th>Type</th>
                                                        <th>Points</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let p of cert!.regression_evaluation.positions; let i = index" 
                                                        (click)="displayPosition(p)" class="clickable" role="button">
                                                        <td *ngIf="(i+1) <= visiblePositions">
                                                            <p class="light-text">{{i+1}}</p>
                                                        </td>
                                                        <td *ngIf="(i+1) <= visiblePositions">
                                                            <p class="show-on-mobile">{{p.ot | date:'short'}}</p>
                                                            <p class="show-on-desktop">{{p.ot | date:'medium'}}</p>
                                                        </td>
                                                        <td *ngIf="(i+1) <= visiblePositions && layout == 'desktop'">
                                                            <p>{{p.ct | date:'medium'}}</p>
                                                        </td>
                                                        <td *ngIf="(i+1) <= visiblePositions">
                                                            <p [ngClass]="{'success-color': p.t == 1, 'error-color': p.t == -1}">
                                                                {{p.t == 1 ? 'Long': 'Short'}}
                                                            </p>
                                                        </td>
                                                        <td *ngIf="(i+1) <= visiblePositions" class="align-right">
                                                            <p [ngClass]="{'success-color': p.o, 'error-color': !p.o}">
                                                                <strong>{{p.pts}}</strong>
                                                            </p>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>

                                        <!-- Paginator -->
                                        <div *ngIf="visiblePositions <= cert!.regression_evaluation.positions.length" class="paginator">
                                            <button mat-button (click)="visiblePositions=visiblePositions+15">View More</button>
                                        </div>
                                    </div>
                                </div>
                            </div>



                            <!-- Epochs -->
                            <div *ngIf="activeTabIndex == 4" class="epochs-content fadeIn">
                                <div fxLayout="row" fxLayoutAlign="center center">
                                    <div fxFlex="60" fxFlex.xs="100" fxFlex.sm="100">
                                        <div class="desktop-card">
                                            <div class="data-container">
                                                <table class="highlight bordered">
                                                    <thead>
                                                        <tr>
                                                            <th></th>
                                                            <th>loss</th>
                                                            <th>val_loss</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr *ngFor="let row of cert.training_history.loss; index as rowIndex">
                                                            <td><p class="light-text">{{rowIndex+1}}</p></td>
                                                            <td><p>{{cert.training_history.loss[rowIndex]}}</p></td>
                                                            <td><p>{{cert.training_history.val_loss[rowIndex]}}</p></td>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </mat-drawer-content>
</mat-drawer-container>