<!-- Section Container -->
<mat-drawer-container class="section-container">

    <!-- Main Sidenav -->
    <mat-drawer #predBacktestingSidenav [(opened)]="predBacktestingSidenavOpened" *ngIf="initialized"
                class="sidenav" position="start" mode="over" autoFocus="false">
        <!-- Menu Heading Toolbar -->
        <mat-toolbar color="primary">
            <div fxLayout="row" fxLayoutAlign="start center">
                <button mat-icon-button (click)="predBacktestingSidenav?.toggle()"><mat-icon>arrow_back</mat-icon></button>
                <span>Server</span>
                <span fxFlex></span>
            </div>
        </mat-toolbar>

        <!-- Menu Content -->
        <mat-list>
            <div mat-subheader>General</div>
            <mat-list-item *ngFor="let sect of generalSections">
                <button mat-button class="left-icon-button" [disabled]="section.id == sect.id" (click)="activateSection(sect)">
                    <mat-icon>{{sect.icon}}</mat-icon> {{sect.name}}
                </button>
            </mat-list-item>
            <div mat-subheader>Models</div>
            <mat-list-item *ngFor="let id of _backtesting.modelIDs">
                <button mat-button class="left-icon-button truncate" 
                        [disabled]="section.id == 'model' && modelID == id" 
                        (click)="activateSection({id: 'model', name: id}, id)">
                        <div fxLayout="row" fxLayoutAlign="start center">
                            <span class="truncate">{{id}}</span>
                            <span fxFlex></span>
                            <div class="badge"><span>{{_backtesting.performances[id].points}}</span></div>
                        </div>
                </button>
            </mat-list-item>
        </mat-list>
    </mat-drawer>


    <!-- Section Content -->
    <mat-drawer-content>
        <!-- Content Header -->
        <mat-toolbar class="secondary-header">
            <div fxLayout="row" fxLayoutAlign="center center">
                <button mat-icon-button (click)="_nav.dashboard()" class="show-on-mobile"><mat-icon>arrow_back</mat-icon></button>
                <button mat-icon-button (click)="predBacktestingSidenav?.toggle()" *ngIf="initialized" class="show-on-mobile"><mat-icon>menu</mat-icon></button>
                <span class="truncate">Prediction Backtesting</span>
                <span fxFlex></span>
                <button mat-icon-button 
                        matTooltip="Clear Backtest Results"
                        (click)="resetResults()"
                        *ngIf="initialized"><mat-icon>close</mat-icon></button>
            </div>
        </mat-toolbar>



        <!-- Uninitialized Content -->
        <div *ngIf="!initialized" class="fadeIn">
            <div fxLayout="row" fxLayoutAlign="center center" class="init-container">
                <!-- Button -->
                <label for="backtestFile" class="file-label" role="button" matRipple *ngIf="!initializing">
                    <div fxLayout="row" fxLayoutAlign="start center" matRipple role="button" tabindex="0">
                        <mat-icon svgIcon="file_waveform"></mat-icon>&nbsp;
                        <p>Select Backtest Files</p>
                    </div>
                </label>

                <!-- Input -->
                <input id="backtestFile" type="file" accept="application/json" (change)="fileChanged($event)" multiple/>

                <!-- Initializing Loader-->
                <h3 *ngIf="initializing" class="fadeIn">Initializing...</h3>
            </div>
        </div>



        <!-- Initialized Content -->
        <div *ngIf="initialized" class="fadeIn">
            <div fxLayout="row">
                <div *ngIf="layout == 'desktop'" class="desktop-sidenav">
                    <mat-list>
                        <div mat-subheader>General</div>
                        <mat-list-item *ngFor="let sect of generalSections">
                            <button mat-button class="left-icon-button" [disabled]="section.id == sect.id" (click)="activateSection(sect)">
                                <mat-icon>{{sect.icon}}</mat-icon> {{sect.name}}
                            </button>
                        </mat-list-item>
                        <div mat-subheader>Models</div>
                        <mat-list-item *ngFor="let id of _backtesting.modelIDs">
                            <button mat-button class="left-icon-button truncate" 
                                    [disabled]="section.id == 'model' && modelID == id" 
                                    (click)="activateSection({id: 'model', name: id}, id)">
                                    <div fxLayout="row" fxLayoutAlign="start center">
                                        <span class="truncate">{{id}}</span>
                                        <span fxFlex></span>
                                        <div class="badge"><span>{{_backtesting.performances[id].points}}</span></div>
                                    </div>
                            </button>
                        </mat-list-item>
                    </mat-list>
                </div>
                <div fxFlex>
                    <!-- Loader -->
                    <div *ngIf="!loaded" class="loader">
                        <div fxLayout="row" fxLayoutAlign="center center"><mat-spinner diameter="50"></mat-spinner></div>
                    </div>

                    <!-- Sections -->
                    <div *ngIf="loaded">
                        <p>Wtf?</p>
                    </div>
                </div>
            </div>
        </div>
    </mat-drawer-content>
</mat-drawer-container>