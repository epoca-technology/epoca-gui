<!-- Secondary Header -->
<mat-toolbar class="secondary-header">
    <div fxLayout="row" fxLayoutAlign="center center">
        <span *ngIf="!epoch" class="truncate">Predictions</span>
        <span *ngIf="epoch" 
                class="truncate clickable" 
                (click)="_nav.displayPredictionModelConfigDialog(epoch.model)">
                {{initialized ? epoch.id: 'Predictions'}}
        </span>
        <span fxFlex></span>
        
        <!-- Chart Settings -->
        <button mat-icon-button *ngIf="initialized && epoch" [matMenuTriggerFor]="menu" [disabled]="!loaded" matTooltip="Set custom date range">
            <mat-icon>date_range</mat-icon>
        </button>
        <mat-menu #menu="matMenu">
            <button mat-menu-item 
                    *ngFor="let item of histMenu" 
                    [disabled]="item.id == activeHistMenuItem.id && item.id != 'custom'" 
                    (click)="loadCandlesticks(item)">{{item.name}}</button>
        </mat-menu>

        <!-- Close Epoch-->
        <button mat-icon-button 
                *ngIf="epoch"
                [disabled]="!loaded"
                matTooltip="Close {{epoch.id}}"
                (click)="initializeEpochData()"><mat-icon>close</mat-icon></button>
    </div>
</mat-toolbar>

<!-- Content -->
<div [ngClass]="{'section-content': layout == 'mobile'}" class="padding">
    <div>
        <!-- Initialization Loader -->
        <div *ngIf="!initialized && initializing" class="section-loader">
            <div fxLayout="row" fxLayoutAlign="center center"><mat-spinner diameter="50"></mat-spinner></div>
        </div>

        <!-- Epoch Menu -->
        <div *ngIf="initialized && !epoch" fxLayout="row" fxLayoutAlign="center center">
            <div fxFlex="30" fxFlex.xs="100" fxFlex.sm="100">
                <app-epochs-menu (epochID)="initializeEpochData($event)"></app-epochs-menu>
            </div>
        </div>

        <!-- Prediction Container -->
        <div *ngIf="initialized && epoch">
            <!-- Loader -->
            <div *ngIf="!loaded" class="section-loader">
                <div fxLayout="row" fxLayoutAlign="center center"><mat-spinner diameter="50"></mat-spinner></div>
            </div>

            <!-- Prediction Candlesticks -->
            <div *ngIf="loaded && candlesticksChart" class="fadeIn">
                <div>
                    <apx-chart
                        [series]="candlesticksChart.series!"
                        [chart]="candlesticksChart.chart!"
                        [plotOptions]="candlesticksChart.plotOptions!"
                        [xaxis]="candlesticksChart.xaxis!"
                        [yaxis]="candlesticksChart.yaxis!"
                        [annotations]="candlesticksChart!.annotations!"
                        [title]="candlesticksChart.title!"
                    ></apx-chart>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Tabs -->
    <app-mobile-tabs *ngIf="layout == 'mobile'"></app-mobile-tabs>
</div>
